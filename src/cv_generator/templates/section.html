{% extends "base.html" %}

{% block title %}{{ section | title }} - {{ person.slug }}{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <a href="{{ url_for('index') }}">Home</a> &raquo;
    <a href="{{ url_for('person_dashboard', person=person.slug) }}">{{ person.display_name or person.slug }}</a> &raquo;
    {{ section | replace('_', ' ') | title }}
</nav>

<h2>{{ section | replace('_', ' ') | title }}</h2>

{% if entries %}
<div class="card">
    <div style="margin-bottom: 1rem;">
        <input type="text" id="search-input" placeholder="Search entries..." 
               style="width: 100%; padding: 0.5rem; border: 1px solid var(--gray-300); border-radius: 4px;">
    </div>
    
    <div id="entries-list">
    {% for entry in entries %}
    <div class="list-item entry-item" data-search="{{ entry.summary | lower }} {{ entry.tags | default([]) | join(' ') | lower }}">
        <div style="flex: 1;">
            <a href="{{ url_for('entry_detail', entry_id=entry.id) }}">
                {{ entry.summary }}
            </a>
            <div class="entry-meta">
                {% if entry.tags %}
                    {% for tag in entry.tags %}
                    <span class="tag">{{ tag }}</span>
                    {% endfor %}
                {% else %}
                    <span style="color: var(--gray-500); font-style: italic;">No tags</span>
                {% endif %}
            </div>
        </div>
        <a href="{{ url_for('entry_detail', entry_id=entry.id) }}" class="btn btn-secondary btn-sm">Edit Tags</a>
    </div>
    {% endfor %}
    </div>
    
    <div id="no-results" style="display: none; text-align: center; padding: 1rem; color: var(--gray-500);">
        No entries match your search.
    </div>
</div>

<script>
document.getElementById('search-input').addEventListener('input', function() {
    const query = this.value.toLowerCase().trim();
    const entries = document.querySelectorAll('.entry-item');
    const noResults = document.getElementById('no-results');
    let visibleCount = 0;
    
    entries.forEach(function(entry) {
        const searchText = entry.getAttribute('data-search');
        if (query === '' || searchText.includes(query)) {
            entry.style.display = 'flex';
            visibleCount++;
        } else {
            entry.style.display = 'none';
        }
    });
    
    noResults.style.display = visibleCount === 0 ? 'block' : 'none';
});
</script>
{% else %}
<div class="card empty-state">
    <p>No entries in this section.</p>
</div>
{% endif %}
{% endblock %}
