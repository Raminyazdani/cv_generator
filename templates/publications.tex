<BLOCK> if publications|length > 1 </BLOCK>

%-------------------------------------------------------------------------------
%  SECTION TITLE
%-------------------------------------------------------------------------------
\cvsection{Publications}

%-------------------------------------------------------------------------------
%  CONTENT
%-------------------------------------------------------------------------------
\begin{cventries}
<BLOCK> for pub in publications </BLOCK>
  % derive year and authors text
  <BLOCK> set year = pub.get('year') or (pub.get('date')[:4] if pub.get('date') else 'n.d.') </BLOCK>
  <BLOCK> set alist = pub.get('authors_structured') or pub.get('authors') or [] </BLOCK>
  <BLOCK> if alist and alist[0] is mapping </BLOCK>
    <BLOCK> set authors_text = (alist | map(attribute='literal') | list) | join(', ') </BLOCK>
  <BLOCK> else </BLOCK>
    <BLOCK> set authors_text = alist | join(', ') </BLOCK>
  <BLOCK> endif </BLOCK>
  % venue/location line by type
  <BLOCK> if pub['type'] == 'Book Chapter' </BLOCK>
    <BLOCK> set venue = pub.get('book_title') or '' </BLOCK>
  <BLOCK> elif pub['type'] in ['Master Thesis','Bachelor Thesis','PhD Thesis','Thesis','Dissertation'] </BLOCK>
    <BLOCK> set venue = pub.get('institution') or '' </BLOCK>
  <BLOCK> else </BLOCK>
    <BLOCK> set venue = pub.get('journal') or pub.get('publisher') or '' </BLOCK>
  <BLOCK> endif </BLOCK>
  \cventry
    {<VAR> pub['type'] | latex_escape </VAR><BLOCK> if pub.get('status') and pub['status'] != 'Published' </BLOCK> â€” <VAR> pub['status'] | latex_escape </VAR><BLOCK> endif </BLOCK>} % type/status
    {%
      \textit{<VAR> pub['title'] | latex_escape </VAR>}%
      <BLOCK> if pub.get('URL') </BLOCK>\,{\href{<VAR> pub['URL'] </VAR>}{\honorlocationstyle{[LINK]}}}<BLOCK> endif </BLOCK>
    } % title (+ short link tag if present)
    {<VAR> venue | latex_escape </VAR>} % venue/journal/book/institution
    {<VAR> year </VAR>} % year
    {%
      \begin{cvitems}
        \item {\textbf{Authors:} <VAR> authors_text | latex_escape </VAR>}
        <BLOCK> if pub['type'] == 'Book Chapter' </BLOCK>
          <BLOCK> if pub.get('editors') </BLOCK>
            \item {\textbf{In:} <VAR> pub['editors'] | join(', ') | latex_escape </VAR> (Eds.)}
          <BLOCK> endif </BLOCK>
          <BLOCK> if pub.get('chapter_pages') </BLOCK>
            \item {\textbf{Pages:} <VAR> pub['chapter_pages'] | latex_escape </VAR>}
          <BLOCK> endif </BLOCK>
          <BLOCK> if pub.get('publisher') </BLOCK>
            \item {\textbf{Publisher:} <VAR> pub['publisher'] | latex_escape </VAR>}
          <BLOCK> endif </BLOCK>
        <BLOCK> elif pub['type'] in ['Master Thesis','Bachelor Thesis','PhD Thesis','Thesis','Dissertation'] </BLOCK>
          <BLOCK> if pub.get('degree_type') </BLOCK>\item {\textbf{Degree:} <VAR> pub['degree_type'] | latex_escape </VAR>}<BLOCK> endif </BLOCK>
          <BLOCK> if pub.get('faculty') or pub.get('school') </BLOCK>
            \item {\textbf{Affiliation:} <VAR> [pub.get('faculty'), pub.get('school')] | reject('equalto', None) | reject('equalto','') | join(', ') | latex_escape </VAR>}
          <BLOCK> endif </BLOCK>
        <BLOCK> else </BLOCK>
          <BLOCK> if pub.get('journal') </BLOCK>
            \item {%
              \textbf{Journal:} <VAR> pub['journal'] | latex_escape </VAR>
              <BLOCK> if pub.get('volume') </BLOCK>, \textbf{<VAR> pub['volume'] | latex_escape </VAR>}<BLOCK> endif </BLOCK>
              <BLOCK> if pub.get('issue') </BLOCK>(<VAR> pub['issue'] | latex_escape </VAR>)<BLOCK> endif </BLOCK>
              <BLOCK> if pub.get('pages') </BLOCK>, <VAR> pub['pages'] | latex_escape </VAR><BLOCK> endif </BLOCK>
            }
          <BLOCK> elif pub.get('publisher') </BLOCK>
            \item {\textbf{Publisher:} <VAR> pub['publisher'] | latex_escape </VAR>}
          <BLOCK> endif </BLOCK>
        <BLOCK> endif </BLOCK>
        % DOI only (no long URL here; short [LINK] already shown after title)
        <BLOCK> set doi = pub.get('identifiers', {}).get('doi') </BLOCK>
        <BLOCK> if doi </BLOCK>
          \item {\textbf{DOI:} \href{https://doi.org/<VAR> doi </VAR>}{https://doi.org/<VAR> doi </VAR>}}
        <BLOCK> endif </BLOCK>
      \end{cvitems}
    }
<BLOCK> endfor </BLOCK>
\end{cventries}
<BLOCK> endif </BLOCK>
